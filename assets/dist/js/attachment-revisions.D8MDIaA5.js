var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});var AttachmentRevisions=AttachmentRevisions||{};AttachmentRevisions.MediaUpload=($=>{var _fileUploader=null,_shouldDeleteAttachment=!0;function MediaUpload(){this.handleEvents()}return __name(MediaUpload,"MediaUpload"),MediaUpload.prototype.handleEvents=function(){$(document).on("click",'[data-action="media-replacer-replace"]',(function(e){this.openFileUploader(e.target)}).bind(this)),$(document).on("click",'[data-action="media-replacer-revisions"]',function(e){if($(this).parents(".media-modal").length)return location.href=$(this).data("edit-link"),!1}),$(document).on("click",".media-button-new",e=>{$(".uploader-inline-content").show(),$(".attachment-details.save-ready").hide(),$(".media-toolbar-primary .media-button-new").remove()}),$(document).on("click",".media-replace-revisions [data-restore]",function(e){if($(this).hasClass("selected")){$('[name="media-replace-restore"]').val(""),$(this).removeClass("selected");return}$(".media-replace-revisions li.selected").removeClass("selected");var path=$(this).data("restore");$('[name="media-replace-restore"]').val(path),$(this).addClass("selected")}),$('[data-action="media-replace-close-thickbox"]').on("click",()=>{$("#TB_closeWindowButton").trigger("click")})},MediaUpload.prototype.openFileUploader=function(element){if($(element).parents(".media-modal").length){location.href=$(element).closest("[data-edit-link]").data("edit-link");return}if(_fileUploader){_fileUploader.open(),$(".media-router a:first-of-type").trigger("click");return}this.setupFileUploader()},MediaUpload.prototype.setupFileUploader=function(){var query=wp.media.query({orderby:"date",query:!0,uploadedTo:-1});_fileUploader=wp.media({title:"Select replacement file",button:{text:mediaReplacer.replace},multiple:!1,states:[new wp.media.controller.Library({library:query})]}),wp.Uploader.queue.on("reset",()=>{$(".uploader-inline-content").hide(),$(".media-toolbar-primary").prepend('<button type="button" class="button media-button button-primary button-large media-button-new">'+mediaReplacer.newImage+"</button>")}),_fileUploader.on("select",()=>{var selected=_fileUploader.state().get("selection").first().toJSON().id;typeof selected<"u"?(_shouldDeleteAttachment=!1,$('[name="media-replacer-replace-with"]').val(selected).closest("form").submit()):alert("You did not select a file. Media will not be replaced.")}),_fileUploader.on("close",()=>{var selected=null;typeof _fileUploader.state().get("selection").first()<"u"&&(selected=_fileUploader.state().get("selection").first().toJSON().id),selected&&setTimeout(()=>{if(!_shouldDeleteAttachment)return!1;$.post(ajaxurl,{action:"attachment_revisions_remove_attachment",id:selected},response=>{console.log(response)})},1e3)}),this.openFileUploader()},new MediaUpload})(jQuery);
//# sourceMappingURL=attachment-revisions.D8MDIaA5.js.map
