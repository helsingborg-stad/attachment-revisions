var AttachmentRevisions=AttachmentRevisions||{},AttachmentRevisions=AttachmentRevisions||{};AttachmentRevisions.MediaUpload=function(e){function t(){e(document).on("click",'[data-attachment-revisions-action="swap-media"]',function(e){e.preventDefault(),this.openUploader()}.bind(this))}var i=null;return t.prototype.openUploader=function(){if(i)return void i.open();console.log(wp);var t=wp.media.query({orderby:"date",query:!0,type:"image",uploadedTo:-1});i=wp.media.frames.fileUploader=wp.media({title:"Media swapper",button:{text:"Swap"},multiple:!1,states:[new wp.media.controller.Library({library:t})]}),i.on("select",function(){var t=i.state().get("selection").first().toJSON(),n={action:"attachment_revisions_swap",id:attachment_revisions_current_post_id,file:t};e.post(ajaxurl,n,function(e){return"success"==e?void location.reload():(alert(e+". Aborting."),!1)})}),i.open(),e(".media-router a:first-of-type").trigger("click")},new t}(jQuery);